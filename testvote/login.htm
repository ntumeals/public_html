<html>
<head><title>infoBaseEnterNumber</title><meta http-equiv="Content-Type" content="text/html; charset=big5">
<script language="JavaScript" type="text/JavaScript">
<!--
function MM_goToURL() { //v3.0
  var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
  for (i=0; i<(args.length-1); i+=2) eval(args[i]+".location='"+args[i+1]+"'");
}
//-->
</script>
</head>
<body bgcolor="#FFFF99">
<%
	Dim id
	Dim secure
	Dim newform
%>
<h1><u><FONT face="標楷體" size="6" color="#006633">登入票選系統</FONT></u></h1>
<%
 
  IF IsObject (Session("InfoBase"))Then
     Set conn = Session("InfoBase")
  ELSE
     Set conn= Server.CreateObject("ADODB.Connection") 
     conn.open "InfoBase"  '開啟 Connection 物件 一定要用DSN的方法才可以
     Set Session("InfoBase") = conn
  END IF
  
  Set rs =Server.CreateObject("ADODB.Recordset")    '製作 Recordset 物件
  rs.Open "基本資料" , conn , 3,3    '開啟 Recordset 物件
  
  id = Request.Form("NUMBER")
  secure = Request.Form("SECURE")
  newform = "login.asp"
  
  RS.MoveFirst
  If id <> ""  Then  '判斷使用者輸入資料與否  
  	IF secure = "" Then
		RESPONSE.Write  "<B>請填入身分證字號！謝謝！"
	ELSE
		RS.Find "編號 = '"&id&"'"
		IF RS.EOF THEN
			RESPONSE.Write  "<B>抱歉 ! 資料庫中沒有擁有編號 "&id& "的人"
		ELSE
			RS.MoveFirst
			RS.Filter = "編號 = '"&id&"' AND 身分證字號 = '"&secure&"'"
     		IF RS.EOF THEN
        		RESPONSE.WRITE "<B>你的身分證字號填錯了喔！請重新輸入。"
     		ELSE
				newform = "prevote.asp"
     			'RESPONSE.WRITE "<B>姓名 : " & RS("姓名") & "<BR>"
     			'RESPONSE.WRITE "<B>身分證字號 : " & RS("身分證字號") & "<BR>"
     			'RESPONSE.WRITE "<HR>"
			END IF
		END IF
	END IF
  End If 
  rs.close
%>
<form method="POST" 
 action=>
輸入編號：  
  <input name="NUMBER" type="text" size="10" maxlength="15">  
<P>
輸入身分證字號：
    <input name="SECURE" type="password" size="15" maxlength="15">  
<P>
    <input name="按鈕" type="button" onClick="MM_goToURL('parent','prevote.htm');return document.MM_returnValue" value="確定送出">
       <input type="reset" value="清        除">
</form>
</body>
</html>